<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Projectile Swarm</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: #0444BC;
    }

    .proj {
        position: absolute;
        width: 64px;
        height: 64px;
        pointer-events: none;
        transform-origin: center;
    }
</style>
</head>
<body>

<script>
const IMG_SRC = "projectile.png";
const RADIUS = 32;

let mouse = { x: innerWidth / 2, y: innerHeight / 2 };
let active = false;
const projectiles = [];

document.addEventListener("mousedown", () => active = true);
document.addEventListener("mouseup", () => active = false);
document.addEventListener("mousemove", e => {
    mouse.x = e.clientX;
    mouse.y = e.clientY;
});

function spawn() {
    const img = document.createElement("img");
    img.src = IMG_SRC;
    img.className = "proj";
    document.body.appendChild(img);

    projectiles.push({
        el: img,
        x: Math.random() * innerWidth,
        y: Math.random() * innerHeight,
        vx: 0,
        vy: 0,
        orbit: Math.random() * 80 + 40,
        angle: Math.random() * Math.PI * 2
    });
}

setInterval(spawn, 1000);

function collide(a, b) {
    const dx = b.x - a.x;
    const dy = b.y - a.y;
    const dist = Math.hypot(dx, dy);
    const min = RADIUS * 2;

    if (dist < min && dist > 0) {
        const overlap = min - dist;
        const nx = dx / dist;
        const ny = dy / dist;

        a.x -= nx * overlap * 0.5;
        a.y -= ny * overlap * 0.5;
        b.x += nx * overlap * 0.5;
        b.y += ny * overlap * 0.5;

        a.vx -= nx * 0.5;
        a.vy -= ny * 0.5;
        b.vx += nx * 0.5;
        b.vy += ny * 0.5;
    }
}

function update() {
    for (let i = 0; i < projectiles.length; i++) {
        const p = projectiles[i];

        let tx, ty;

        if (active) {
            tx = mouse.x;
            ty = mouse.y;
        } else {
            p.angle += 0.03;
            tx = p.x + Math.cos(p.angle) * p.orbit;
            ty = p.y + Math.sin(p.angle) * p.orbit;
        }

        const dx = tx - p.x;
        const dy = ty - p.y;

        p.vx += dx * 0.015;
        p.vy += dy * 0.015;

        p.vx *= 0.93;
        p.vy *= 0.93;

        p.x += p.vx;
        p.y += p.vy;

        for (let j = i + 1; j < projectiles.length; j++) {
            collide(p, projectiles[j]);
        }

        const rot = Math.atan2(p.vy, p.vx) * 180 / Math.PI;

        p.el.style.left = (p.x - RADIUS) + "px";
        p.el.style.top = (p.y - RADIUS) + "px";
        p.el.style.transform = `rotate(${rot}deg)`;
    }

    requestAnimationFrame(update);
}

update();
</script>

</body>
  </html>
